# 使用 ansible 部署 kubernetes

> 前置条件：物料准备好(cfssl, etcd, flannel, kubernetes 组件)放在部署节点的 /data/pkg 目录下
>   配置好证书，生成 token.csv,生成 bootstrap.kubeconfig kube-proxy.kubeconfig

## 环境初始化，分 master 和 node

1. 安装基本运维工具
2. 关闭防火墙 swap，开启 ipv6 等
3. 创建相应的目录

## 安装 Docker-CE(node 节点)

1. 配置 docker 仓库
2. 配置 docker 阿里源

## cfssl 生成证书(master 节点)

1. 创建 CA
2. 创建 etcd kube-apiserver kube-proxy 证书
3. 将相应证书分发至相应的节点

## 部署 etcd(etcd 节点)

1. 创建配置文件模板
2. 创建启动文件模板
3. 通过模板生成实际文件

## 部署 flannel(node 节点)

1. 创建模板文件
2. etcd 写入网段信息

## 部署 kube-apiserver(master 节点)

## 部署 kube-schedular(master 节点)

## 部署 ???
